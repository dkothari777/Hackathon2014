<!DOCTYPE html>
<html>
    <head>
        <title> Java Fiddle </title> 
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <link href="../static/style.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <!-- BEGIN HEADER -->
        <header> 
            <h1> Java Fiddle  </h1>
        </header>
        <!-- END HEADER -->


<pre id="editor">System.out.print("Hello World!");
</pre>

<script src="http://code.jquery.com/jquery-1.11.0.min.js">
            //var socket;
            var host = "ws://localhost:8080/java";
     
            var socket = new WebSocket(host);
 
            socket.onmessage = function(msg){
                var msgevent = msg.data;
                document.getElementById('OutputContent').innerHTML = msgevent;
            };

            socket.onopen = function(){
                alert("Hello");
            };

            socket.onclose = function(){
                socket = new WebSocket(host);
            }

     
            function writeConsole(){
                socket.send(editor.getValue());
            }

            $('#disconnect').click(function(){
                socket.close();
            });
        </script>

        <div id="Output">
            <p id="OutputContent">
            
            </p>
        </div>
        <input type="button" id="compile" value="Compile" onClick="sendData()" \>
        
        <input type="button" id="cancel" value="Cancel" onClick="clearConsole()"\>
        
        <script src="../static/ace.js" type="text/javascript" charset="utf-8"></script>
        <script>
            var editor = ace.edit("editor");
            editor.setTheme("ace/theme/github");
            editor.getSession().setMode("ace/mode/java");
        </script>
        <script>
            var socket = new WebSocket("ws://localhost:8080/java")
            
            function getCookie(cname)
            {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for(var i=0; i<ca.length; i++) 
              {
              var c = ca[i].trim();
              if (c.indexOf(name)==0) return c.substring(name.length,c.length);
              }
            return "";
            }

            function clearConsole(e) {
                document.getElementById('OutputContent').innerHTML = "";
                socket.close();
            }

            function sendData() {
                cookieData = getCookie( "plainssid" );
                socket.send( cookieData + " " + editor.getValue() );
            }

            socket.onmessage = function(msg){
                var msgevent = msg.data;
                document.getElementById('OutputContent').innerHTML = msgevent;
            };
        </script>
        <footer>
            <p>
                <a href="https://github.com/dkothari777/Hackathon2014">Java Fiddle GitHub</a> 
            </p>
        </footer>
    </body>

</html>
